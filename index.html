<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World 1st Study Hub | Full Owner Control</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        * { margin:0; padding:0; box-sizing:border-box; font-family:'Poppins', sans-serif; }
        body { background: radial-gradient(circle at center, #1b2735 0%, #090a0f 100%); color: white; min-height: 100vh; overflow-x: hidden; }
        #stars-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: url('https://www.transparenttextures.com/patterns/stardust.png'); animation: moveStars 100s linear infinite; opacity: 0.5; }
        @keyframes moveStars { from { background-position: 0 0; } to { background-position: 10000px 5000px; } }
        
        /* --- Three Dots Menu Style --- */
        .menu-wrapper { position: fixed; top: 20px; right: 20px; z-index: 1100; text-align: right; }
        .dots-btn { background: rgba(0, 242, 255, 0.2); border: 1px solid #00f2ff; color: #00f2ff; width: 45px; height: 45px; border-radius: 50%; font-size: 1.2rem; cursor: pointer; transition: 0.3s; }
        .dots-btn:hover { background: #00f2ff; color: #000; }
        
        .menu-content { display: none; margin-top: 10px; flex-direction: column; gap: 8px; animation: fadeIn 0.3s ease; }
        .menu-content.active { display: flex; }
        
        .nav-link { color: white; text-decoration: none; font-size: 0.85rem; background: rgba(0, 0, 0, 0.8); padding: 10px 20px; border-radius: 12px; border: 1px solid rgba(0,242,255,0.3); transition: 0.3s; white-space: nowrap; }
        .nav-link:hover { border-color: #00f2ff; background: rgba(0, 242, 255, 0.1); }
        .nav-link.hidden { display: none; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        .header { text-align: center; padding: 80px 20px 40px; }
        .logo { font-size: 40px; font-weight: bold; text-shadow: 0 0 20px #00f2ff; margin-bottom: 20px; }
        
        #admin-panel { display: none; background: #2ecc71; color: white; padding: 15px; text-align: center; font-weight: bold; position: sticky; top: 0; z-index: 1000; }
        .owner-btn { background: #00f2ff; color: #000; border: none; padding: 10px 20px; border-radius: 50px; font-weight: bold; cursor: pointer; margin: 10px; transition: 0.3s; }
        .owner-btn:hover { transform: scale(1.1); background: #fff; }

        .search-container { position: relative; max-width: 600px; margin: 0 auto 30px; }
        .search-container input { width: 100%; padding: 15px 25px; border-radius: 50px; border: 2px solid rgba(0, 242, 255, 0.4); background: rgba(0, 0, 0, 0.8); color: white; outline: none; }

        .subjects { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; padding: 20px; max-width: 1200px; margin: 0 auto; }
        .card { background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255,255,255,0.1); padding: 30px; border-radius: 20px; text-align: center; cursor: pointer; transition: 0.4s ease; backdrop-filter: blur(10px); position: relative; }
        .card:hover { border-color: #00f2ff; background: rgba(0, 242, 255, 0.1); }
        .card i { font-size: 3rem; margin-bottom: 10px; display: block; }
        
        .del-subj { position: absolute; top: 10px; right: 10px; background: red; color: white; border: none; border-radius: 50%; width: 25px; height: 25px; cursor: pointer; display: none; }

        .notes-section { display: none; padding: 30px; max-width: 900px; margin: 20px auto; background: rgba(0,0,0,0.9); border-radius: 25px; border: 1px solid #00f2ff; }

        .unit-card { background: rgba(255,255,255,0.05); margin: 10px 0; padding: 15px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; border: 1px solid rgba(255,255,255,0.1); cursor:pointer; }
        .unit-card:hover { background: rgba(255,255,255,0.1); }
        .unit-card.active-unit { border: 1px solid #00f2ff; background: rgba(0, 242, 255, 0.1); }
        
        .controls { display: flex; gap: 8px; }
        .ctrl-btn { border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 0.7rem; font-weight: bold; }
        .btn-edit { background: #ffd43b; }
        .btn-del { background: #ff5e62; color: white; }

        #pdf-upload-box{ margin-top:20px; padding:15px; border-radius:15px; background:rgba(255,255,255,0.05); border:1px solid rgba(0,242,255,0.4); display:none; text-align: center; }
        #pdfFileInput { margin-bottom: 10px; color: #fff; }
        #pdfUrlInput { width: 100%; padding: 10px; margin-bottom: 10px; border-radius: 8px; border: 1px solid #00f2ff; background: rgba(0,0,0,0.5); color: white; }

        .chat-btn { position: fixed; bottom: 25px; right: 25px; width: 60px; height: 60px; background: #10a37f; border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; box-shadow: 0 5px 20px rgba(0,0,0,0.5); }
        footer { padding: 30px; text-align: center; opacity: 0.5; cursor: pointer; }
    </style>
</head>
<body>

<div id="stars-container"></div>

<div class="menu-wrapper">
    <button class="dots-btn" onclick="toggleMenu()"><i class="fa-solid fa-ellipsis-vertical"></i></button>
    <div class="menu-content" id="menuLinks">
        <a href="#" id="link-gen" class="nav-link"><i class="fa-solid fa-wand-magic-sparkles"></i> Image Generation</a>
        <a href="#" id="link-pdf" class="nav-link"><i class="fa-solid fa-file-pdf"></i> PDF Tools</a>
        <a href="https://chatgpt.com" target="_blank" id="link-chat" class="nav-link"><i class="fa-solid fa-comment-dots"></i> ChatGPT</a>
    </div>
</div>

<div id="admin-panel">
    üõ°Ô∏è OWNER DASHBOARD | 
    <button class="owner-btn" onclick="addSubject()">+ Add Subject</button>
    <button class="owner-btn" style="background:#f39c12;" onclick="manageFeatures()">Manage Features</button>
    <button class="owner-btn" style="background:#ff5252; color:#fff;" onclick="ownerExit()">Exit Owner</button>
</div>

<div class="header">
    <div class="logo">üöÄ STUDY HUB</div>
    <div class="search-container">
        <input type="text" id="masterSearch" placeholder="Search for subjects or notes..." onkeyup="handleSearch()">
    </div>
</div>

<div class="subjects" id="mainGrid"></div>

<div class="notes-section" id="notesArea">
    <h2 id="noteTitle"></h2>
    <div id="unitList"></div>
    
    <div id="add-unit-container" style="display:none; margin-top:20px; text-align:center;">
        <button class="owner-btn" onclick="addNewUnit()">+ Add New Unit</button>
    </div>
    
    <div id="pdf-upload-box">
        <p id="targetUnitDisplay" style="font-size: 0.8rem; color: #00f2ff; margin-bottom: 5px;">Select a unit to set PDF</p>
        
        <input type="text" id="pdfUrlInput" placeholder="Paste PDF URL here...">
        
        <input type="file" id="pdfFileInput" accept="application/pdf">
        
        <button class="owner-btn" onclick="handlePdfSave()">Save PDF Data</button>
        <div id="pdfStatus"></div>
    </div>

    <button class="owner-btn" style="background:#ff5722; color:white; margin-top:20px;" onclick="hideNotes()">‚Üê Back</button>
</div>

<div class="chat-btn" onclick="window.open('https://www.google.com', '_blank')">
    <i class="fa-solid fa-robot" style="color:white; font-size:1.5rem;"></i>
</div>

<footer ondblclick="adminLogin()">¬© 2026 Education Portal </footer>

<script>
    let isAdmin = false;
    let currentSubjectKey = '';
    let selectedUnitIndex = null;
    let features = { 'link-gen': true, 'link-pdf': true, 'link-chat': true };

    let subjectData = {
        'python': { title: 'Python', icon: 'fa-brands fa-python', color: '#ffd43b', units: ['Unit 1: Introduction', 'Unit 2: Data Types'], links: ['#', '#'] },
        'c': { title: 'C Language', icon: 'fa-solid fa-c', color: '#00599C', units: ['Unit 1: Basics of C', 'Unit 2: Arrays & Pointers'], links: ['#', '#'] },
        'ai': { title: 'AI', icon: 'fa-solid fa-brain', color: '#00f2ff', units: ['Unit 1: Introduction to AI', 'Unit 2: Machine Learning'], links: ['#', '#'] }
    };

    function toggleMenu() {
        document.getElementById('menuLinks').classList.toggle('active');
    }

    function manageFeatures() {
        const choice = prompt("Type 'image', 'pdf', or 'chat' to toggle visibility:").toLowerCase();
        if(choice === 'image') features['link-gen'] = !features['link-gen'];
        if(choice === 'pdf') features['link-pdf'] = !features['link-pdf'];
        if(choice === 'chat') features['link-chat'] = !features['link-chat'];
        updateFeatureUI();
    }

    function updateFeatureUI() {
        for (let id in features) {
            document.getElementById(id).classList.toggle('hidden', !features[id]);
        }
    }

    function renderDashboard() {
        const grid = document.getElementById('mainGrid');
        grid.innerHTML = '';
        for (let key in subjectData) {
            grid.innerHTML += `
                <div class="card" onclick="showNotes('${key}')">
                    ${isAdmin ? `<button class="del-subj" onclick="event.stopPropagation(); deleteSubject('${key}')">√ó</button>` : ''}
                    <i class="${subjectData[key].icon}" style="color: ${subjectData[key].color}"></i>
                    <h3>${subjectData[key].title}</h3>
                </div>`;
        }
        document.querySelectorAll('.del-subj').forEach(b => b.style.display = isAdmin ? 'block' : 'none');
    }

    function showNotes(key) {
        currentSubjectKey = key;
        document.getElementById('mainGrid').style.display = 'none';
        document.getElementById('notesArea').style.display = 'block';
        document.getElementById('noteTitle').innerText = subjectData[key].title;
        
        // Hide/Show owner-only sections
        document.getElementById('add-unit-container').style.display = isAdmin ? 'block' : 'none';
        document.getElementById('pdf-upload-box').style.display = isAdmin ? 'block' : 'none';
        
        selectedUnitIndex = null;
        renderUnits();
    }

    function renderUnits() {
        const list = document.getElementById('unitList');
        list.innerHTML = '';
        subjectData[currentSubjectKey].units.forEach((unit, i) => {
            const isActive = selectedUnitIndex === i ? 'active-unit' : '';
            list.innerHTML += `
                <div class="unit-card ${isActive}" onclick="handleUnitClick(${i})">
                    <span>${unit}</span>
                    <div class="controls" onclick="event.stopPropagation();">
                        ${isAdmin ? `<button class="ctrl-btn btn-edit" onclick="editUnitName(${i})">Edit</button>` : ''}
                        ${isAdmin ? `<button class="ctrl-btn btn-del" onclick="deleteUnit(${i})">Del</button>` : ''}
                        <button class="ctrl-btn" onclick="openPdf(${i})" style="background:#00f2ff; color:black;">
                            <i class="fa-solid fa-file-pdf"></i>
                        </button>
                    </div>
                </div>`;
        });
    }

    function handleUnitClick(i) {
        if (isAdmin) {
            selectedUnitIndex = i;
            const unitName = subjectData[currentSubjectKey].units[i];
            document.getElementById('targetUnitDisplay').innerText = "Targeting: " + unitName;
            renderUnits();
        } else {
            openPdf(i);
        }
    }

    function openPdf(i) {
        const dataUrl = subjectData[currentSubjectKey].links[i];
        if (dataUrl && dataUrl !== '#') {
            if (dataUrl.startsWith('data:application/pdf')) {
                 const byteString = atob(dataUrl.split(',')[1]);
                 const mimeString = dataUrl.split(',')[0].split(':')[1].split(';')[0];
                 const ab = new ArrayBuffer(byteString.length);
                 const ia = new Uint8Array(ab);
                 for (let i = 0; i < byteString.length; i++) ia[i] = byteString.charCodeAt(i);
                 const blob = new Blob([ab], {type: mimeString});
                 window.open(URL.createObjectURL(blob), '_blank');
            } else {
                window.open(dataUrl, '_blank');
            }
        } else {
            alert("No PDF available.");
        }
    }

    function handlePdfSave() {
        if (!isAdmin || selectedUnitIndex === null) {
            alert("Select a unit card first!");
            return;
        }
        
        const urlInput = document.getElementById('pdfUrlInput');
        const fileInput = document.getElementById('pdfFileInput');
        
        // Priority 1: URL input
        if (urlInput.value.trim() !== "") {
            subjectData[currentSubjectKey].links[selectedUnitIndex] = urlInput.value.trim();
            alert("URL Saved!");
            urlInput.value = "";
            renderUnits();
        } 
        // Priority 2: File upload
        else if (fileInput.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                subjectData[currentSubjectKey].links[selectedUnitIndex] = e.target.result;
                alert("File Uploaded!");
                fileInput.value = "";
                renderUnits();
            };
            reader.readAsDataURL(fileInput.files[0]);
        } else {
            alert("Please provide a URL or select a file.");
        }
    }

    function adminLogin() {
        const name = prompt("Owner Name:");
        const pass = prompt("Owner Pass:");
        if (name === "study" && pass === "11") {
            isAdmin = true;
            document.getElementById('admin-panel').style.display = 'block';
            renderDashboard();
            if(document.getElementById('notesArea').style.display === 'block') {
                document.getElementById('add-unit-container').style.display = 'block';
                document.getElementById('pdf-upload-box').style.display = 'block';
                renderUnits();
            }
        }
    }

    function ownerExit() {
        isAdmin = false;
        document.getElementById('admin-panel').style.display = 'none';
        document.getElementById('pdf-upload-box').style.display = 'none';
        document.getElementById('add-unit-container').style.display = 'none';
        renderDashboard();
        renderUnits();
    }

    function addSubject() {
        if(!isAdmin) return;
        let name = prompt("Enter Subject Name:");
        if (name) {
            let key = name.toLowerCase().replace(/\s/g, '');
            subjectData[key] = { title: name, icon: 'fa-solid fa-book', color: '#fff', units: [], links: [] };
            renderDashboard();
        }
    }

    function deleteSubject(key) {
        if (isAdmin && confirm("Delete?")) { delete subjectData[key]; renderDashboard(); }
    }

    function addNewUnit() {
        if(!isAdmin) return;
        let name = prompt("Unit Name:");
        if (name) {
            subjectData[currentSubjectKey].units.push(name);
            subjectData[currentSubjectKey].links.push("#");
            renderUnits();
        }
    }

    function editUnitName(i) {
        if(!isAdmin) return;
        let n = prompt("New Name:", subjectData[currentSubjectKey].units[i]);
        if (n) { subjectData[currentSubjectKey].units[i] = n; renderUnits(); }
    }

    function deleteUnit(i) {
        if(!isAdmin) return;
        if(confirm("Delete Unit?")) {
            subjectData[currentSubjectKey].units.splice(i, 1);
            subjectData[currentSubjectKey].links.splice(i, 1);
            renderUnits();
        }
    }

    function hideNotes() {
        document.getElementById('mainGrid').style.display = 'grid';
        document.getElementById('notesArea').style.display = 'none';
    }

    function handleSearch() {
        let filter = document.getElementById('masterSearch').value.toLowerCase();
        document.querySelectorAll('.card').forEach(c => {
            c.style.display = c.innerText.toLowerCase().includes(filter) ? 'block' : 'none';
        });
    }

    renderDashboard();
</script>
</body>
</html>
